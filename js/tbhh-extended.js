/* tbhh-extended.js - Minified 2025-08-25 */
window.tbhhExtended={setupAgentBypass:function(e){if("true"===(e=>{const t=document.cookie.match(new RegExp("(^| )"+e+"=([^;]+)"));return t?t[2]:null})("agent_bypass")){console.log("✅ Agent bypass cookie detected. Suppressing registration popup.");const t=setInterval(()=>{if("object"==typeof e&&e.closePop)try{e.closePop(),e.openSignLog=()=>console.log("🚫 Registration popup blocked (agent bypass)."),clearInterval(t)}catch(e){console.warn("Bypass error:",e)}},300);setTimeout(()=>clearInterval(t),5e3)}else console.log("ℹ️ No agent bypass cookie detected.")},setupPhoneReplacement:function(){function e(){const e=document.querySelectorAll(".schedule-agent-info a.phone:not(.replaced)");console.log("Found .schedule-agent-info a.phone elements:",e.length),e.forEach((e,t)=>{console.log(`Phone link ${t} before:`,e.outerHTML);const o=document.createElement("button"),n=e.textContent.replace(/^\+1/,"");o.textContent=n,o.style.fontSize="20px",o.style.fontWeight="bold",o.style.backgroundColor="#23c864",o.style.color="#000000",o.style.border="none",o.style.padding="8px 16px",o.style.cursor="pointer",o.style.borderRadius="4px",o.style.display="block",o.style.margin="10px auto",o.style.width="100%",o.style.marginLeft="-30px",o.style.marginRight="-30px",o.style.boxSizing="border-box";const s=e.closest(".schedule-agent-info");s?(e.parentNode.removeChild(e),s.appendChild(o),o.classList.add("replaced"),console.log(`Phone link ${t} after:`,o.outerHTML)):console.log(`Phone link ${t} error: .schedule-agent-info not found`)})}if(console.log("Phone link replacement loaded via CDN"),window.location.href.startsWith("https://tampabayhousehunter.com/listing-detail/")){document.addEventListener("DOMContentLoaded",function(){e()});let t=!1;new MutationObserver(()=>{t||(t=!0,e(),t=!1)}).observe(document.body,{childList:!0,subtree:!0})}},setupAgentMenuReplacement:function(){const e="David",t=[`Meet ${e}`,`Sold By ${e}`],o=window.location.hostname;if(!("tampabayhousehunter.com"!==o&&o.endsWith("tampabayhousehunter.com")))return;let n="";const s=o.split(".")[0];if(n=s.charAt(0).toUpperCase()+s.slice(1),!n)return void console.log("❌ Couldn't extract agent name from subdomain");function l(){const o=document.querySelectorAll("a, button, span, .dropdown-item, .menu-item");let s=0;o.forEach(o=>{o.textContent&&t.forEach(t=>{if(o.textContent.includes(t)){const l=o.textContent.replace(t,t.replace(e,n));o.textContent=l,s++}})}),s>0&&console.log(`✅ Replaced ${s} menu items with ${n}'s name`)}console.log(`✅ Replacing menu items with agent name: ${n}`),l();new MutationObserver(()=>{l()}).observe(document.body,{childList:!0,subtree:!0})},init:function(e){this.setupAgentBypass(e),this.setupPhoneReplacement(),this.setupAgentMenuReplacement(),console.log("✅ TBHH Extended features initialized")}};